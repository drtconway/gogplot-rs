/// The Old Faithful Geyser dataset
///
/// Waiting time between eruptions and the duration of the eruption for the
/// Old Faithful geyser in Yellowstone National Park, Wyoming, USA.
///
/// ## Format
///
/// A data frame with 272 observations on 2 variables:
///
/// - `eruptions`: Eruption time in minutes
/// - `waiting`: Waiting time to next eruption (in minutes)
///
/// ## Description
///
/// A version of the eruptions data from the Old Faithful geyser in Yellowstone
/// National Park, Wyoming. This dataset is perfect for demonstrating bivariate
/// relationships and binning operations.
///
/// ## Source
///
/// Härdle, W. (1991) Smoothing Techniques with Implementation in S.
/// New York: Springer.
///
/// Azzalini, A. and Bowman, A. W. (1990). A look at some data on the Old
/// Faithful geyser. Applied Statistics 39, 357–365.

use crate::data::DataSource;
use crate::utils::dataframe::DataFrame;

pub fn faithful() -> Box<dyn DataSource> {
    let mut df = DataFrame::new();

    let eruptions = vec![
        3.600, 1.800, 3.333, 2.283, 4.533, 2.883, 4.700, 3.600, 1.950, 4.350,
        1.833, 3.917, 4.200, 1.750, 4.700, 2.167, 1.750, 4.800, 1.600, 4.250,
        1.800, 1.750, 3.450, 3.067, 4.533, 3.600, 1.967, 4.083, 3.850, 4.433,
        4.300, 4.467, 3.367, 4.033, 3.833, 2.017, 1.867, 4.833, 1.833, 4.783,
        4.350, 1.883, 4.567, 1.750, 4.533, 3.317, 3.833, 2.100, 4.633, 2.000,
        4.800, 4.716, 1.833, 4.833, 1.733, 4.883, 3.717, 1.667, 4.567, 4.317,
        2.233, 4.500, 1.750, 4.800, 1.817, 4.400, 4.167, 4.700, 2.067, 4.700,
        4.033, 1.967, 4.500, 4.000, 1.983, 5.067, 2.017, 4.567, 3.883, 3.600,
        4.133, 4.333, 4.100, 2.633, 4.067, 4.933, 3.950, 4.517, 2.167, 4.000,
        2.200, 4.333, 1.867, 4.817, 1.833, 4.300, 4.667, 3.750, 1.867, 4.900,
        2.483, 4.367, 2.100, 4.500, 4.050, 1.867, 4.700, 1.783, 4.850, 3.683,
        4.733, 2.300, 4.900, 4.417, 1.700, 4.633, 2.317, 4.600, 1.817, 4.417,
        2.617, 4.067, 4.250, 1.967, 4.600, 3.767, 1.917, 4.500, 2.267, 4.650,
        1.867, 4.167, 2.800, 4.333, 1.833, 4.383, 1.883, 4.933, 2.033, 3.733,
        4.233, 2.233, 4.533, 4.817, 4.333, 1.983, 4.633, 2.017, 5.100, 1.800,
        5.033, 4.000, 2.400, 4.600, 3.567, 4.000, 4.500, 4.083, 1.800, 3.967,
        2.200, 4.150, 2.000, 3.833, 3.500, 4.583, 2.367, 5.000, 1.933, 4.617,
        1.917, 2.083, 4.583, 3.333, 4.167, 4.333, 4.500, 2.417, 4.000, 4.167,
        1.883, 4.583, 4.250, 3.767, 2.033, 4.433, 4.083, 1.833, 4.417, 2.183,
        4.800, 1.833, 4.800, 4.100, 3.966, 4.233, 3.500, 4.366, 2.250, 4.667,
        2.100, 4.350, 4.133, 1.867, 4.600, 1.783, 4.367, 3.850, 1.933, 4.500,
        2.383, 4.700, 1.867, 3.833, 3.417, 4.233, 2.400, 4.800, 2.000, 4.150,
        1.867, 4.267, 1.750, 4.483, 4.000, 4.117, 4.083, 4.267, 3.917, 4.550,
        4.083, 2.417, 4.183, 2.217, 4.450, 1.883, 1.850, 4.283, 3.950, 2.333,
        4.150, 2.350, 4.933, 2.900, 4.583, 3.833, 2.083, 4.367, 2.133, 4.350,
        2.200, 4.450, 3.567, 4.500, 4.150, 3.817, 3.917, 4.450, 2.000, 4.283,
        4.767, 4.533, 1.850, 4.250, 1.983, 2.250, 4.750, 4.117, 2.150, 4.417,
        1.817, 4.467,
    ];

    let waiting = vec![
        79.0, 54.0, 74.0, 62.0, 85.0, 55.0, 88.0, 85.0, 51.0, 85.0,
        54.0, 84.0, 78.0, 47.0, 83.0, 52.0, 62.0, 84.0, 52.0, 79.0,
        51.0, 47.0, 78.0, 69.0, 74.0, 83.0, 55.0, 76.0, 78.0, 79.0,
        73.0, 77.0, 66.0, 80.0, 74.0, 52.0, 48.0, 80.0, 59.0, 90.0,
        80.0, 58.0, 84.0, 58.0, 73.0, 83.0, 64.0, 53.0, 82.0, 59.0,
        75.0, 90.0, 54.0, 80.0, 54.0, 83.0, 71.0, 64.0, 77.0, 81.0,
        59.0, 84.0, 48.0, 82.0, 60.0, 92.0, 78.0, 78.0, 65.0, 73.0,
        82.0, 56.0, 79.0, 71.0, 62.0, 76.0, 60.0, 78.0, 76.0, 83.0,
        75.0, 82.0, 70.0, 65.0, 73.0, 88.0, 76.0, 80.0, 48.0, 86.0,
        60.0, 90.0, 50.0, 78.0, 63.0, 72.0, 84.0, 75.0, 51.0, 82.0,
        62.0, 88.0, 49.0, 83.0, 81.0, 47.0, 84.0, 52.0, 86.0, 81.0,
        75.0, 59.0, 89.0, 79.0, 59.0, 81.0, 50.0, 85.0, 59.0, 87.0,
        53.0, 69.0, 77.0, 56.0, 88.0, 81.0, 45.0, 82.0, 55.0, 90.0,
        45.0, 83.0, 56.0, 89.0, 46.0, 82.0, 51.0, 86.0, 53.0, 79.0,
        81.0, 60.0, 82.0, 77.0, 76.0, 59.0, 80.0, 49.0, 96.0, 53.0,
        77.0, 77.0, 65.0, 81.0, 71.0, 70.0, 81.0, 93.0, 53.0, 89.0,
        45.0, 86.0, 58.0, 78.0, 66.0, 76.0, 63.0, 88.0, 52.0, 93.0,
        49.0, 57.0, 77.0, 68.0, 81.0, 81.0, 73.0, 50.0, 85.0, 74.0,
        55.0, 77.0, 83.0, 83.0, 51.0, 78.0, 84.0, 46.0, 83.0, 55.0,
        81.0, 57.0, 76.0, 84.0, 77.0, 81.0, 87.0, 77.0, 51.0, 78.0,
        60.0, 82.0, 91.0, 53.0, 78.0, 46.0, 77.0, 84.0, 49.0, 83.0,
        71.0, 80.0, 49.0, 75.0, 64.0, 76.0, 53.0, 94.0, 55.0, 76.0,
        50.0, 82.0, 54.0, 75.0, 78.0, 79.0, 78.0, 78.0, 70.0, 79.0,
        70.0, 54.0, 86.0, 50.0, 90.0, 54.0, 54.0, 77.0, 79.0, 64.0,
        75.0, 47.0, 86.0, 63.0, 85.0, 82.0, 57.0, 82.0, 67.0, 74.0,
        54.0, 83.0, 73.0, 73.0, 88.0, 80.0, 71.0, 83.0, 56.0, 79.0,
        78.0, 84.0, 58.0, 83.0, 43.0, 60.0, 75.0, 81.0, 46.0, 90.0,
        46.0, 74.0,
    ];

    df.add_column("eruptions", eruptions);
    df.add_column("waiting", waiting);

    Box::new(df)
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_faithful_dimensions() {
        let data = faithful();
        assert_eq!(data.len(), 272);
        assert!(data.column_names().contains(&"eruptions".to_string()));
        assert!(data.column_names().contains(&"waiting".to_string()));
    }
}

use std::sync::Arc;

/// The sp500 dataset - S&P 500 Index Historical Data from 2007
///
/// This dataset contains daily data for the S&P 500 stock market index for the year 2007,
/// which includes the period leading up to the financial crisis.
/// The data includes open, high, low, close prices, trading volume, and adjusted close.
///
/// ## Format
///
/// A data frame with 251 observations (trading days in 2007) on 7 variables:
///
/// - `date`: Trading date (string format YYYY-MM-DD)
/// - `open`: Opening price
/// - `high`: Highest price of the day
/// - `low`: Lowest price of the day
/// - `close`: Closing price
/// - `volume`: Trading volume (integer)
/// - `adj_close`: Adjusted closing price
///
/// ## Source
///
/// Historical S&P 500 index data

use crate::data::DataSource;
use crate::utils::dataframe::{DataFrame, FloatVec, IntVec, StrVec};

/// Load the sp500 dataset (2007 data)
///
/// Returns a DataFrame containing S&P 500 index data from 2007.
///
/// # Example
///
/// ```rust,ignore
/// use gogplot::utils::sp500::sp500;
/// use gogplot::prelude::*;
///
/// let data = sp500();
/// let plot = Plot::new(Some(data))
///     .aes(|a| {
///         a.x("date");
///         a.y("close");
///     })
///     .geom_line();
/// ```
pub fn sp500() -> Box<dyn DataSource> {
    let mut df = DataFrame::new();
    
    // Trading dates for 2007 (chronological order, oldest to newest)
    let dates = vec![
        "2007-01-03", "2007-01-04", "2007-01-05", "2007-01-08", "2007-01-09", "2007-01-10", "2007-01-11", "2007-01-12",
        "2007-01-16", "2007-01-17", "2007-01-18", "2007-01-19", "2007-01-22", "2007-01-23", "2007-01-24", "2007-01-25",
        "2007-01-26", "2007-01-29", "2007-01-30", "2007-01-31", "2007-02-01", "2007-02-02", "2007-02-05", "2007-02-06",
        "2007-02-07", "2007-02-08", "2007-02-09", "2007-02-12", "2007-02-13", "2007-02-14", "2007-02-15", "2007-02-16",
        "2007-02-20", "2007-02-21", "2007-02-22", "2007-02-23", "2007-02-26", "2007-02-27", "2007-02-28", "2007-03-01",
        "2007-03-02", "2007-03-05", "2007-03-06", "2007-03-07", "2007-03-08", "2007-03-09", "2007-03-12", "2007-03-13",
        "2007-03-14", "2007-03-15", "2007-03-16", "2007-03-19", "2007-03-20", "2007-03-21", "2007-03-22", "2007-03-23",
        "2007-03-26", "2007-03-27", "2007-03-28", "2007-03-29", "2007-03-30", "2007-04-02", "2007-04-03", "2007-04-04",
        "2007-04-05", "2007-04-09", "2007-04-10", "2007-04-11", "2007-04-12", "2007-04-13", "2007-04-16", "2007-04-17",
        "2007-04-18", "2007-04-19", "2007-04-20", "2007-04-23", "2007-04-24", "2007-04-25", "2007-04-26", "2007-04-27",
        "2007-04-30", "2007-05-01", "2007-05-02", "2007-05-03", "2007-05-04", "2007-05-07", "2007-05-08", "2007-05-09",
        "2007-05-10", "2007-05-11", "2007-05-14", "2007-05-15", "2007-05-16", "2007-05-17", "2007-05-18", "2007-05-21",
        "2007-05-22", "2007-05-23", "2007-05-24", "2007-05-25", "2007-05-29", "2007-05-30", "2007-05-31", "2007-06-01",
        "2007-06-04", "2007-06-05", "2007-06-06", "2007-06-07", "2007-06-08", "2007-06-11", "2007-06-12", "2007-06-13",
        "2007-06-14", "2007-06-15", "2007-06-18", "2007-06-19", "2007-06-20", "2007-06-21", "2007-06-22", "2007-06-25",
        "2007-06-26", "2007-06-27", "2007-06-28", "2007-06-29", "2007-07-02", "2007-07-03", "2007-07-05", "2007-07-06",
        "2007-07-09", "2007-07-10", "2007-07-11", "2007-07-12", "2007-07-13", "2007-07-16", "2007-07-17", "2007-07-18",
        "2007-07-19", "2007-07-20", "2007-07-23", "2007-07-24", "2007-07-25", "2007-07-26", "2007-07-27", "2007-07-30",
        "2007-07-31", "2007-08-01", "2007-08-02", "2007-08-03", "2007-08-06", "2007-08-07", "2007-08-08", "2007-08-09",
        "2007-08-10", "2007-08-13", "2007-08-14", "2007-08-15", "2007-08-16", "2007-08-17", "2007-08-20", "2007-08-21",
        "2007-08-22", "2007-08-23", "2007-08-24", "2007-08-27", "2007-08-28", "2007-08-29", "2007-08-30", "2007-08-31",
        "2007-09-04", "2007-09-05", "2007-09-06", "2007-09-07", "2007-09-10", "2007-09-11", "2007-09-12", "2007-09-13",
        "2007-09-14", "2007-09-17", "2007-09-18", "2007-09-19", "2007-09-20", "2007-09-21", "2007-09-24", "2007-09-25",
        "2007-09-26", "2007-09-27", "2007-09-28", "2007-10-01", "2007-10-02", "2007-10-03", "2007-10-04", "2007-10-05",
        "2007-10-08", "2007-10-09", "2007-10-10", "2007-10-11", "2007-10-12", "2007-10-15", "2007-10-16", "2007-10-17",
        "2007-10-18", "2007-10-19", "2007-10-22", "2007-10-23", "2007-10-24", "2007-10-25", "2007-10-26", "2007-10-29",
        "2007-10-30", "2007-10-31", "2007-11-01", "2007-11-02", "2007-11-05", "2007-11-06", "2007-11-07", "2007-11-08",
        "2007-11-09", "2007-11-12", "2007-11-13", "2007-11-14", "2007-11-15", "2007-11-16", "2007-11-19", "2007-11-20",
        "2007-11-21", "2007-11-23", "2007-11-26", "2007-11-27", "2007-11-28", "2007-11-29", "2007-11-30", "2007-12-03",
        "2007-12-04", "2007-12-05", "2007-12-06", "2007-12-07", "2007-12-10", "2007-12-11", "2007-12-12", "2007-12-13",
        "2007-12-14", "2007-12-17", "2007-12-18", "2007-12-19", "2007-12-20", "2007-12-21", "2007-12-24", "2007-12-26",
        "2007-12-27", "2007-12-28", "2007-12-31",
    ];
    
    let open = vec![
        1418.03, 1416.6, 1418.34, 1409.26, 1412.84, 1408.7, 1414.84, 1423.8199, 1430.73, 1431.77,
        1430.59, 1426.35, 1430.47, 1422.95, 1427.96, 1440.12, 1423.9, 1422.03, 1420.61, 1428.65,
        1437.9, 1445.9399, 1448.33, 1446.98, 1447.41, 1449.99, 1448.25, 1438.0, 1433.22, 1443.91,
        1455.15, 1456.77, 1455.53, 1459.6, 1457.29, 1456.22, 1451.04, 1449.25, 1398.64, 1406.8,
        1403.16, 1387.11, 1374.0601, 1395.02, 1391.88, 1401.89, 1402.8, 1406.23, 1377.86, 1387.11,
        1392.28, 1386.95, 1402.04, 1410.92, 1435.04, 1434.54, 1436.11, 1437.49, 1428.35, 1417.17,
        1422.52, 1420.83, 1424.27, 1437.75, 1438.9399, 1443.77, 1444.58, 1448.23, 1438.87, 1447.8,
        1452.84, 1468.47, 1471.47, 1472.48, 1470.6899, 1484.33, 1480.9301, 1480.28, 1495.27, 1494.21,
        1494.0699, 1482.37, 1486.13, 1495.5601, 1502.35, 1505.5699, 1509.36, 1507.3199, 1512.33, 1491.47,
        1505.76, 1503.11, 1500.75, 1514.01, 1512.74, 1522.75, 1525.1, 1524.09, 1522.1, 1507.5,
        1515.55, 1517.6, 1530.1899, 1530.62, 1536.28, 1539.12, 1530.5699, 1517.36, 1490.71, 1507.64,
        1509.12, 1492.65, 1515.58, 1522.97, 1532.9, 1531.02, 1533.6801, 1512.5, 1522.1899, 1502.5601,
        1497.6801, 1492.62, 1506.3199, 1505.7, 1504.66, 1519.12, 1524.86, 1524.96, 1530.4301, 1531.85,
        1509.9301, 1518.74, 1547.6801, 1552.5, 1549.52, 1549.2, 1546.13, 1553.1899, 1534.0601, 1541.5699,
        1511.03, 1518.09, 1482.4399, 1458.9301, 1473.9, 1455.1801, 1465.46, 1472.1801, 1433.04, 1467.62,
        1476.22, 1497.21, 1453.09, 1453.42, 1452.87, 1426.15, 1406.64, 1411.26, 1445.9399, 1445.55,
        1447.03, 1464.05, 1462.34, 1479.36, 1466.72, 1432.01, 1463.67, 1457.61, 1473.96, 1488.76,
        1472.03, 1478.55, 1453.5, 1451.6899, 1471.1, 1471.47, 1483.95, 1484.24, 1476.63, 1519.75,
        1528.6899, 1518.75, 1525.75, 1516.34, 1518.62, 1527.3199, 1531.24, 1527.29, 1546.96, 1545.8,
        1539.91, 1543.84, 1556.51, 1553.1801, 1564.98, 1564.72, 1555.41, 1562.25, 1547.8101, 1544.4399,
        1539.29, 1540.0, 1497.79, 1509.3, 1516.61, 1516.15, 1522.17, 1536.92, 1539.42, 1532.15,
        1545.79, 1511.0699, 1505.61, 1505.33, 1515.46, 1475.27, 1467.59, 1453.66, 1441.35, 1483.4,
        1468.04, 1453.09, 1456.7, 1434.51, 1434.71, 1417.62, 1440.74, 1409.59, 1432.95, 1467.41,
        1471.83, 1479.63, 1471.34, 1465.22, 1484.59, 1508.6, 1505.11, 1516.6801, 1487.58, 1483.27,
        1486.1899, 1465.05, 1445.92, 1454.7, 1456.42, 1463.1899, 1484.55, 1495.12, 1495.05, 1479.83,
        1475.25,
    ];
    
    let high = vec![
        1429.42, 1421.84, 1418.34, 1414.98, 1415.61, 1415.99, 1427.12, 1431.23, 1433.9301, 1435.27,
        1432.96, 1431.5699, 1431.39, 1431.33, 1440.14, 1440.6899, 1427.27, 1426.9399, 1428.8199, 1441.61,
        1446.64, 1449.33, 1449.38, 1450.1899, 1452.99, 1450.45, 1452.45, 1439.11, 1444.41, 1457.65,
        1457.97, 1456.77, 1460.53, 1459.6, 1461.5699, 1456.22, 1456.95, 1449.25, 1415.89, 1409.46,
        1403.4, 1391.86, 1397.9, 1401.16, 1407.9301, 1410.15, 1409.34, 1406.23, 1388.09, 1395.73,
        1397.51, 1403.2, 1411.53, 1437.77, 1437.66, 1438.89, 1437.65, 1437.49, 1428.35, 1426.24,
        1429.22, 1425.49, 1440.5699, 1440.16, 1444.88, 1448.1, 1448.73, 1448.39, 1448.02, 1453.11,
        1468.62, 1474.35, 1476.5699, 1474.23, 1484.74, 1487.3199, 1483.8199, 1496.59, 1498.02, 1497.3199,
        1497.16, 1487.27, 1499.1, 1503.34, 1510.34, 1511.0, 1509.36, 1513.8, 1512.33, 1506.24,
        1510.9, 1514.83, 1514.15, 1517.14, 1522.75, 1529.87, 1529.24, 1532.4301, 1529.3101, 1517.41,
        1521.8, 1530.23, 1535.5601, 1540.5601, 1540.53, 1539.12, 1530.5699, 1517.36, 1507.76, 1515.53,
        1511.33, 1515.7, 1526.45, 1538.71, 1535.4399, 1535.85, 1537.3199, 1522.9, 1522.1899, 1514.29,
        1506.12, 1506.8, 1514.84, 1517.53, 1519.45, 1526.01, 1526.5699, 1532.4, 1534.26, 1531.85,
        1519.34, 1547.92, 1555.1, 1555.9, 1555.3199, 1549.2, 1555.2, 1553.1899, 1547.23, 1541.5699,
        1524.3101, 1518.09, 1488.53, 1477.88, 1488.3, 1468.38, 1476.4301, 1473.23, 1467.67, 1488.3,
        1503.89, 1497.21, 1462.02, 1466.29, 1456.74, 1440.78, 1415.97, 1450.33, 1451.75, 1455.3199,
        1464.86, 1472.0601, 1479.4, 1479.36, 1466.72, 1463.76, 1468.4301, 1481.47, 1496.4, 1488.76,
        1481.49, 1478.55, 1462.25, 1472.48, 1479.5, 1489.58, 1485.99, 1484.24, 1519.89, 1538.74,
        1529.14, 1530.89, 1530.1801, 1518.27, 1529.39, 1532.46, 1533.74, 1549.02, 1548.01, 1545.84,
        1544.02, 1561.91, 1556.51, 1565.26, 1565.42, 1576.09, 1563.03, 1564.74, 1547.8101, 1550.66,
        1542.79, 1540.0, 1508.0601, 1520.01, 1517.23, 1523.24, 1535.53, 1544.67, 1539.42, 1552.76,
        1545.79, 1513.15, 1510.84, 1520.77, 1515.46, 1482.5, 1474.09, 1464.9399, 1481.37, 1492.14,
        1472.67, 1462.1801, 1456.7, 1452.64, 1436.4, 1440.86, 1446.09, 1429.49, 1471.62, 1473.8101,
        1488.9399, 1481.16, 1471.34, 1486.09, 1508.02, 1510.63, 1518.27, 1523.5699, 1511.96, 1489.4,
        1486.67, 1465.05, 1460.16, 1464.42, 1461.53, 1485.4, 1497.63, 1498.85, 1495.05, 1488.01,
        1475.83,
    ];
    
    let low = vec![
        1407.86, 1408.4301, 1405.75, 1403.97, 1405.42, 1405.3199, 1414.84, 1422.58, 1428.62, 1428.5699,
        1424.21, 1425.1899, 1420.4, 1421.66, 1427.96, 1422.34, 1416.96, 1418.46, 1420.61, 1424.78,
        1437.9, 1444.49, 1443.85, 1443.4, 1446.4399, 1442.8101, 1433.4399, 1431.4399, 1433.22, 1443.91,
        1453.1899, 1451.5699, 1449.2, 1452.02, 1450.51, 1448.36, 1445.48, 1389.42, 1396.65, 1380.87,
        1386.87, 1373.97, 1374.0601, 1390.64, 1391.88, 1397.3, 1398.4, 1377.71, 1363.98, 1385.16,
        1383.63, 1386.95, 1400.7, 1409.75, 1429.88, 1433.21, 1423.28, 1425.54, 1414.0699, 1413.27,
        1408.9, 1416.37, 1424.27, 1435.08, 1436.67, 1443.28, 1443.99, 1436.15, 1433.91, 1444.15,
        1452.84, 1467.15, 1466.41, 1464.47, 1470.6899, 1480.1899, 1473.74, 1480.28, 1491.17, 1488.67,
        1482.29, 1476.7, 1486.13, 1495.5601, 1501.8, 1505.54, 1500.66, 1503.77, 1491.42, 1491.47,
        1498.34, 1500.4301, 1500.75, 1509.29, 1512.74, 1522.71, 1522.05, 1521.9, 1505.1801, 1507.5,
        1512.02, 1510.0601, 1528.26, 1530.62, 1532.3101, 1525.62, 1514.13, 1490.37, 1487.41, 1503.35,
        1492.97, 1492.65, 1515.58, 1522.97, 1529.3101, 1525.67, 1512.36, 1504.75, 1500.74, 1492.6801,
        1490.54, 1484.1801, 1503.41, 1493.61, 1504.66, 1519.12, 1517.72, 1520.47, 1527.45, 1510.01,
        1506.1, 1518.74, 1544.85, 1546.6899, 1547.74, 1533.67, 1546.13, 1529.2, 1534.0601, 1508.62,
        1503.73, 1465.3, 1458.95, 1454.3199, 1454.25, 1439.59, 1460.58, 1432.8, 1427.39, 1455.8,
        1476.22, 1453.09, 1429.74, 1451.54, 1426.2, 1404.36, 1370.6, 1411.26, 1430.54, 1439.76,
        1447.03, 1453.88, 1460.54, 1465.98, 1432.01, 1432.01, 1451.25, 1457.61, 1472.15, 1466.34,
        1467.41, 1449.0699, 1439.29, 1451.6899, 1465.75, 1471.47, 1473.1801, 1471.8199, 1476.63, 1519.75,
        1516.42, 1518.75, 1516.15, 1507.13, 1518.62, 1525.8101, 1521.99, 1527.25, 1540.37, 1536.34,
        1537.63, 1543.84, 1549.0, 1551.8199, 1555.46, 1546.72, 1554.09, 1540.8101, 1536.29, 1526.01,
        1531.76, 1500.26, 1490.4, 1503.61, 1489.5601, 1500.46, 1520.1801, 1536.4301, 1529.55, 1529.4,
        1506.66, 1492.53, 1489.95, 1499.0699, 1475.04, 1450.3101, 1448.51, 1438.53, 1441.35, 1466.47,
        1443.49, 1443.99, 1430.42, 1419.28, 1415.64, 1417.62, 1406.1, 1407.4301, 1432.95, 1458.36,
        1470.89, 1470.08, 1460.66, 1465.22, 1482.1899, 1502.66, 1504.96, 1475.99, 1468.23, 1469.21,
        1467.78, 1445.4301, 1435.65, 1445.3101, 1447.22, 1463.1899, 1484.55, 1488.2, 1475.86, 1471.7,
        1465.13,
    ];
    
    let close = vec![
        1416.6, 1418.34, 1409.71, 1412.84, 1412.11, 1414.85, 1423.8199, 1430.73, 1431.9, 1430.62,
        1426.37, 1430.5, 1422.95, 1427.99, 1440.13, 1423.9, 1422.1801, 1420.62, 1428.8199, 1438.24,
        1445.9399, 1448.39, 1446.99, 1448.0, 1450.02, 1448.3101, 1438.0601, 1433.37, 1444.26, 1455.3,
        1456.8101, 1455.54, 1459.6801, 1457.63, 1456.38, 1451.1899, 1449.37, 1399.04, 1406.8199, 1403.17,
        1387.17, 1374.12, 1395.41, 1391.97, 1401.89, 1402.84, 1406.6, 1377.95, 1387.17, 1392.28,
        1386.95, 1402.0601, 1410.9399, 1435.04, 1434.54, 1436.11, 1437.5, 1428.61, 1417.23, 1422.53,
        1420.86, 1424.55, 1437.77, 1439.37, 1443.76, 1444.61, 1448.39, 1438.87, 1447.8, 1452.85,
        1468.33, 1471.48, 1472.5, 1470.73, 1484.35, 1480.9301, 1480.41, 1495.42, 1494.25, 1494.0699,
        1482.37, 1486.3, 1495.92, 1502.39, 1505.62, 1509.48, 1507.72, 1512.58, 1491.47, 1505.85,
        1503.15, 1501.1899, 1514.14, 1512.75, 1522.75, 1525.1, 1524.12, 1522.28, 1507.51, 1515.73,
        1518.11, 1530.23, 1530.62, 1536.34, 1539.1801, 1530.95, 1517.38, 1490.72, 1507.67, 1509.12,
        1493.0, 1515.67, 1522.97, 1532.91, 1531.05, 1533.7, 1512.84, 1522.1899, 1502.5601, 1497.74,
        1492.89, 1506.34, 1505.71, 1503.35, 1519.4301, 1524.87, 1525.4, 1530.4399, 1531.85, 1510.12,
        1518.76, 1547.7, 1552.5, 1549.52, 1549.37, 1546.17, 1553.08, 1534.1, 1541.5699, 1511.04,
        1518.09, 1482.66, 1458.95, 1473.91, 1455.27, 1465.8101, 1472.2, 1433.0601, 1467.67, 1476.71,
        1497.49, 1453.09, 1453.64, 1452.92, 1426.54, 1406.7, 1411.27, 1445.9399, 1445.55, 1447.12,
        1464.0699, 1462.5, 1479.37, 1466.79, 1432.36, 1463.76, 1457.64, 1473.99, 1489.42, 1472.29,
        1478.55, 1453.55, 1451.7, 1471.49, 1471.5601, 1483.95, 1484.25, 1476.65, 1519.78, 1529.03,
        1518.75, 1525.75, 1517.73, 1517.21, 1525.42, 1531.38, 1526.75, 1547.04, 1546.63, 1539.59,
        1542.84, 1557.59, 1552.58, 1565.15, 1562.47, 1554.41, 1561.8, 1548.71, 1538.53, 1541.24,
        1540.08, 1500.63, 1506.33, 1519.59, 1515.88, 1514.4, 1535.28, 1540.98, 1531.02, 1549.38,
        1508.4399, 1509.65, 1502.17, 1520.27, 1475.62, 1474.77, 1453.7, 1439.1801, 1481.05, 1470.58,
        1451.15, 1458.74, 1433.27, 1439.7, 1416.77, 1440.7, 1407.22, 1428.23, 1469.02, 1469.72,
        1481.14, 1472.42, 1462.79, 1485.01, 1507.34, 1504.66, 1515.96, 1477.65, 1486.59, 1488.41,
        1467.95, 1445.9, 1454.98, 1453.0, 1460.12, 1484.46, 1496.45, 1497.66, 1476.27, 1478.49,
        1468.36,
    ];
    
    let volume = vec![
        3429160000i64, 3004460000, 2919400000, 2763340000, 3038380000, 2764660000, 2857870000, 2686480000,
        2599530000, 2690270000, 2822430000, 2777480000, 2540120000, 2975070000, 2783180000, 2994330000,
        2626620000, 2730480000, 2706250000, 2976690000, 2914890000, 2569450000, 2439430000, 2608710000,
        2618820000, 2816180000, 2951810000, 2395680000, 2652150000, 2699290000, 2490920000, 2399450000,
        2337860000, 2606980000, 1950770000, 2579950000, 2822170000, 4065230000, 3925250000, 3874910000,
        3312260000, 3480520000, 3358160000, 3141350000, 3014850000, 2623050000, 2664000000, 3485570000,
        3758350000, 2821900000, 3393640000, 2777180000, 2795940000, 3184770000, 3129970000, 2619020000,
        2754660000, 2673040000, 3000440000, 2854710000, 2903960000, 2875880000, 2921760000, 2616320000,
        2357230000, 2349410000, 2510110000, 2950190000, 2770570000, 2690020000, 2870140000, 2920570000,
        2971330000, 2913610000, 3329940000, 2575020000, 3119750000, 3252590000, 3211800000, 2732810000,
        3093420000, 3400350000, 3189800000, 3007970000, 2761930000, 2545090000, 2795720000, 2935550000,
        3031240000, 2720780000, 2776130000, 3071020000, 2915350000, 2868640000, 2959050000, 3465360000,
        2860500000, 3084260000, 3365530000, 2316250000, 2571790000, 2980210000, 3335530000, 2927020000,
        2738930000, 2939450000, 2964190000, 3538470000, 2993460000, 2525280000, 3056200000, 3077930000,
        2813630000, 3406030000, 2480240000, 2873590000, 3286900000, 3161110000, 4284320000, 3287250000,
        3398530000, 3398150000, 3006710000, 3165410000, 2648990000, 1560790000, 2622950000, 2441520000,
        2715330000, 3244280000, 3082920000, 3489600000, 2801120000, 2704110000, 3007140000, 3609220000,
        3251450000, 3745780000, 3102700000, 4115830000, 4283200000, 4472550000, 4784650000, 4128780000,
        4524520000, 5256780000, 4368850000, 4272110000, 5067200000, 4909390000, 5499560000, 5889600000,
        5345780000, 3696280000, 3814630000, 4290930000, 6509300000, 3570040000, 3321340000, 3012150000,
        3309120000, 3084390000, 2541400000, 2406180000, 3078090000, 2824070000, 2582960000, 2731610000,
        2766600000, 2991600000, 2459590000, 3191080000, 2835720000, 3015330000, 2885720000, 2877080000,
        2641740000, 2598390000, 3708940000, 3846750000, 2957700000, 3679460000, 3131310000, 3187770000,
        3237390000, 2872180000, 2925350000, 3281990000, 3101910000, 3065320000, 2690430000, 2919030000,
        2040650000, 2932040000, 3044760000, 3911260000, 2788690000, 3139290000, 3234560000, 3638070000,
        3203210000, 4160970000, 3471830000, 3309120000, 4003300000, 4183960000, 3612120000, 3124480000,
        3212520000, 3953070000, 4241470000, 4285990000, 3819330000, 3879160000, 4353160000, 5439720000,
        4587050000, 4192520000, 4141310000, 4031470000, 3941010000, 4168870000, 4119650000, 4875150000,
        4076230000, 1612720000, 3706470000, 4320720000, 4508020000, 3524730000, 4422200000, 3323250000,
        3343620000, 3663660000, 3568570000, 3177710000, 2911760000, 4080180000, 4482120000, 3635170000,
        3401050000, 3569030000, 3723690000, 3401300000, 3526890000, 4508590000, 1267420000, 2010500000,
        2365770000, 2420510000, 2440880000,
    ];
    
    let adj_close = close.clone(); // For 2007, adjusted close == close
    
    df.add_column("date", Arc::new(StrVec(dates.into_iter().map(|s| s.to_string()).collect())));
    df.add_column("open", Arc::new(FloatVec(open)));
    df.add_column("high", Arc::new(FloatVec(high)));
    df.add_column("low", Arc::new(FloatVec(low)));
    df.add_column("close", Arc::new(FloatVec(close)));
    df.add_column("volume", Arc::new(IntVec(volume)));
    df.add_column("adj_close", Arc::new(FloatVec(adj_close)));
    
    Box::new(df)
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_sp500_dimensions() {
        let data = sp500();
        assert_eq!(data.len(), 251, "Should have 251 rows of 2007 data");
        
        // Check that all columns exist
        assert!(data.get("date").is_some());
        assert!(data.get("open").is_some());
        assert!(data.get("high").is_some());
        assert!(data.get("low").is_some());
        assert!(data.get("close").is_some());
        assert!(data.get("volume").is_some());
        assert!(data.get("adj_close").is_some());
    }

    #[test]
    fn test_sp500_column_types() {
        let data = sp500();
        
        // Date should be strings
        let date = data.get("date").unwrap();
        assert!(date.iter_str().is_some());
        
        // Close should be floats
        let close = data.get("close").unwrap();
        assert!(close.iter_float().is_some());
        
        // Volume should be integers
        let volume = data.get("volume").unwrap();
        assert!(volume.iter_int().is_some());
    }

    #[test]
    fn test_sp500_values() {
        let data = sp500();
        
        // Check that we have valid close prices
        let close = data.get("close").unwrap();
        let close_values: Vec<f64> = close.iter_float().unwrap().collect();
        assert_eq!(close_values.len(), 251);
        assert!((close_values[0] - 1416.6).abs() < 0.1, "First close price should be 1416.6");
        assert!((close_values[250] - 1468.36).abs() < 0.1, "Last close price should be 1468.36");
    }
    
    #[test]
    fn test_sp500_chronological_order() {
        let data = sp500();
        
        // Check dates are in chronological order (oldest to newest)
        let dates = data.get("date").unwrap();
        let date_strs: Vec<&str> = dates.iter_str().unwrap().collect();
        
        assert_eq!(date_strs[0], "2007-01-03", "First date should be 2007-01-03");
        assert_eq!(date_strs[250], "2007-12-31", "Last date should be 2007-12-31");
    }
}
